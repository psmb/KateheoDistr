#                                                                        #
# Security policy for the Neos.Demo package                 #
#                                                                        #

privilegeTargets:
  'TYPO3\Flow\Security\Authorization\Privilege\Method\MethodPrivilege':

    Sfi_Kateheo_RegistrationAccess:
      matcher: method(Neos\Demo\Controller\RegistrationController->(index|newAccount|createAccount|createTemporaryAccount)Action())
    Sfi_Kateheo_FlickrAccess:
      matcher: method(Neos\Demo\Controller\FlickrController->(tagStream|userStream)Action())

  'TYPO3\TYPO3CR\Security\Authorization\Privilege\Node\ReadNodePrivilege':

    'Sfi.Kateheo:MembersArea':
      # fee74676-c42f-89da-208e-1741a66525d4 is the node identifier of the "member-area" node, by default located at "/sites/neosdemo/member-area"
      matcher: 'isDescendantNodeOf("443492e5-985f-4560-86b8-83f7ca9c0e39")'

roles:

  'TYPO3.Flow:Everybody':
    privileges:
      -
        privilegeTarget: Sfi_Kateheo_RegistrationAccess
        permission: GRANT
      -
        privilegeTarget: Sfi_Kateheo_FlickrAccess
        permission: GRANT


  'Flowpack.Neos.FrontendLogin:User':
    privileges:
      -
          # Grant "frontend users" to access the "Member area"
        privilegeTarget: 'Sfi.Kateheo:MembersArea'
        permission: GRANT

  'TYPO3.Neos:Editor':
    privileges:
      -
          # Grant "backend users" to access the "Member area" - Otherwise those pages would be hidden in the backend, too!
        privilegeTarget: 'Sfi.Kateheo:MembersArea'
        permission: GRANT
